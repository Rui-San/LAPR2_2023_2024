@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

title US020 - Sequence Diagram (SD)

autonumber

actor "Green Space\nManager" as GSM
participant ":registerGreenSpaceUI" as UI
participant ":registerGreenSpaceController" as CTRL
participant ":Repositories" as REPO
participant "repositories\n:Repositories" as REPOInstance
participant ":greenSpaceRepository" as GSRepo
participant ":GreenSpace" as GS
participant ":Address" as Address

activate GSM

    GSM -> UI : asks to create a new Green Space
    activate UI

        UI --> CTRL** : create
loop until selected data is validated
        UI --> GSM : Displays the types of green spaces and asks\nto select one (garden, medium, large)
    deactivate UI

    GSM -> UI : selects type of green space
    activate UI
end loop
        UI --> UI : keepData(type)
loop until typed data is validated
        UI --> GSM : requests data (name, streetNumber,\npostalCode, city, district, totalArea)
    deactivate UI

    GSM -> UI : types requested data
    activate UI
end loop
        UI --> UI : keepData(name,streetNumber,\npostalCode,city,district,totalArea)
        UI --> GSM : shows all data and requests confirmation
    deactivate UI

    GSM -> UI : confirms data
    activate UI

        UI --> CTRL : createGreenSpace(type,name,streetNumber,\npostalCode,city,district,totalArea)
        activate CTRL

            CTRL --> REPO : getInstance()
            activate REPO

                REPO --> CTRL : repositories
            deactivate REPO

            CTRL --> REPOInstance : getGreenSpaceRepository()
            activate REPOInstance

                REPOInstance --> CTRL : greenSpaceRepository
            deactivate REPOInstance

            CTRL --> GSRepo : createGreenSpace(type,name,streetNumber,\npostalCode,city,district,totalArea)
            activate GSRepo

                GSRepo --> GS** : new GreenSpace(type,name,streetNumber,\npostalCode,city,district,totalArea)
                    GS --> GS : validateName(name)
                    GS --> Address** : new Address(streetNumber,\npostalCode,city,district)
                        Address --> Address : validateStreet(street)
                        Address --> Address : validateStreetNumber(number)
                        Address --> Address : validatePostalCode(postalCode)
                        Address --> Address : validateCity(city)
                        Address --> Address : validateDistrict(district)
                    GS --> GS : validateTotalArea(totalArea)
                GSRepo --> GSRepo : add(newGreenSpace)
                GSRepo --> GSRepo : validateGreenSpace(newGreenSpace)
                GSRepo --> CTRL : operation success
            deactivate GSRepo

            CTRL --> UI : operation success
        deactivate CTRL

        UI --> GSM : displays operation success
    deactivate GSM

@enduml